workflows:
  sample-workflow:
    name: NumeroPrimo WorkFlow
    max_build_duration: 120
    instance_type: mac_mini_m2
    environment:
      android:
        sdk: 30
    scripts:
      - name: Iniando emulado
        script: |
          echo "insltando Android 30"
          yes | sdkmanager "system-images;android-30;google_apis;x86"
          echo "no" | avdmanager create avd -n test -k "system-images;android-30;google_apis;x86" --device "pixel"
          $ANDROID_HOME/emulator/emulator -avd test -no-audio -no-window -gpu off &
          adb wait-for-device
          adb shell input keyevent 82

      - name: Testes
        script: |
          ./gradlew connectedAndroidTest
          adb logcat -d > emulator.log

    artifacts:
      - emulator.log
      - app/build/reports/androidTests/connected/**/*
